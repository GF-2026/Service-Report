<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>REPORTE DE SERVICIO</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
    <script>
        const DEV_MODE = true;

        if (DEV_MODE) {
            document.addEventListener('DOMContentLoaded', () => {
                document.querySelectorAll('input[type="checkbox"]').forEach(chk => {
                    chk.checked = false;
                });
            });
        }
  window.onload = function () {
    alert(
      "üëã ¬°Hola compa√±ero Especialista!\n\n" +
      "üü° Los campos marcados en color √ÅMBAR son\n" +
      "üìå ESTRICTAMENTE REQUERIDOS para crear el PDF\n\n" +
      "‚ö†Ô∏è Favor de validarlos antes de mandar el reporte\n\n" +
      "üèÜüöÄüí™ ¬°MUCHO √âXITO!"
    );
  };
</script>

</head>

<body>
    <div class="container">
        <header>
            <img id="logo" src="LOGO.png" alt="FIXSER">
            <div>
                <h1>REPORTE DE SERVICIO</h1>
                <div class="muted">Llena el formulario, firma y presiona "Guardar registro".</div>
            </div>
        </header>

        <form id="reportForm" class="card">
            <!-- 1 ‚Äì Datos de cliente -->
            <div class="section-header"><strong>1 ‚Äì Datos de cliente</strong>
                <div class="muted">Campos obligatorios *</div>
            </div>
            <div class="grid">
                <div><label>OT: *</label><input type="text" id="OT" required class="special-box"></div>
                <div><label>Fecha y Hora: *</label><input type="datetime-local" id="datetime" required class="special-box"></div>
                <div><label>Compa√±√≠a:</label><input type="text" id="company" required class="special-box"></div>
                <div><label>Ingeniero a cargo:</label><input type="text" id="engineer" required class="special-box"></div>
                <div><label>Tel√©fono:</label><input type="text" id="phone"></div>
                <div><label>Ciudad:</label><input type="text" id="city" required class="special-box"></div>
            </div>

            <!-- 2 ‚Äì Datos del equipo -->
            <hr>
            <div class="section-header"><strong>2 ‚Äì Datos del equipo</strong></div>
            <div class="grid">
                <div><label>Descripci√≥n:</label><input type="text" id="description" required class="special-box"></div>
                <div><label>Marca:</label><input type="text" id="brand" required class="special-box"></div>
                <div><label>Modelo:</label><input type="text" id="model" required class="special-box"></div>
                <div><label>Serie:</label><input type="text" id="serial" required class="special-box"></div>
                <div><label>N√∫mero de control:</label><input type="text" id="controlnum" required class="special-box"></div>
                <div><label>'Est√° disponible el equipo?</label><input type="text" id="status_test" required class="special-box"></div>
            </div>

            <!-- 3 ‚Äì Condiciones ambientales -->
            <hr>
            <div class="section-header"><strong>3 ‚Äì Condiciones ambientales</strong></div>
            <div class="grid">
                <div class="fullwidth"><label>Ubicaci√≥n dentro de la planta:</label><input type="text" id="ubication" required class="special-box">
                </div>
                <div><label>Temperatura (¬∞C):</label><input type="number" step="0.1" id="temperature"required class="special-box"></div>
                <div><label>Humedad (%):</label><input type="number" step="0.1" id="humidity"></div>
            </div>
            <!-- 4 ‚Äì Mediciones -->
            <hr>
            <div class="section-header"><strong>4 ‚Äì Mediciones</strong></div>
            <div class="grid">
                    <div class="mediciones">
                        <div>
                            <label>Presi√≥n Est√°tica LS:*</label><br>
                            <input type="number" step="1" id="static_ls" required class="special-box">
                            <label>Psi</label><br>
                        </div>

                        <div>
                            <label>Presi√≥n Est√°tica HS:*</label><br>
                            <input type="number" step="1" id="static_hs" required class="special-box">
                            <label>Psi</label><br>
                        </div>

                        <div>
                            <label>Resistencia compresor HS o 1er compresor (Œ©):</label><br>
                            <div><label>T1-T2*<input type="number" id="resistance_hs_rs" required class="special-box"></label></div>
                            <div><label>T1-T3*<input type="number" id="resistance_hs_rt" required class="special-box"></label></div>
                            <div><label>T2-T3*<input type="number" id="resistance_hs_st" required class="special-box"></label></div>
                        </div>

                        <div>
                            <label>A tierra:*</label><br>
                            <input type="number" id="resistance_hs_to_ground" required class="special-box">
                        </div>

                        <div>
                            <label>Resistencia compresor LS o 2do compresor(Œ©):</label><br>
                            <div><label>T1-T2*<input type="number" id="resistance_ls_rs" required class="special-box"></label></div>
                            <div><label>T1-T3*<input type="number" id="resistance_ls_rt" required class="special-box"></label></div>
                            <div><label>T2-T3*<input type="number" id="resistance_ls_st" required class="special-box"></label></div>
                        </div>

                        <div>
                            <label>A tierra:*</label><br>
                            <input type="number" id="resistance_ls_to_ground" required class="special-box">
                        </div>


                        <div>
                            <label>Resistencia heater 1 (Œ©):</label><br>
                            <div><label>H1-H2*<input type="number" id="resistance_heat1_rs"  required class="special-box"></label></div>
                            <div><label>H1-H3*<input type="number" id="resistance_heat1_rt"  required class="special-box"></label></div>
                            <div><label>H2-H3*<input type="number" id="resistance_heat1_st"  required class="special-box"></label></div>
                        </div>

                        <div>
                            <label>A tierra:*</label><br>
                            <input type="number" id="resistance_heat1_to_ground" required class="special-box">
                        </div>


                        <div>
                            <label>Resistencia heater 2 (Œ©):</label><br>
                            <div><label>H1-H2*<input type="number" id="resistance_heat2_rs"></label></div>
                            <div><label>H1-H3*<input type="number" id="resistance_heat2_rt"></label></div>
                            <div><label>H2-H3*<input type="number" id="resistance_heat2_st"></label></div>
                        </div>

                        <div>
                            <label>A tierra:*</label><br>
                            <input type="number" id="resistance_heat2_to_ground">
                        </div>


                        <div>
                            <label>Resistencia heater 3 (Œ©):</label><br>
                            <div><label>H1-H2*<input type="number" id="resistance_heat3_rs"></label></div>
                            <div><label>H1-H3*<input type="number" id="resistance_heat3_rt"></label></div>
                            <div><label>H2-H3*<input type="number" id="resistance_heat3_st"></label></div>
                        </div>

                        <div>
                            <label>A tierra:*</label><br>
                            <input type="number" id="resistance_heat3_to_ground"></div>

                        <div>
                            <label>Resistencia humidificador 1(Œ©):</label><br>
                            <input type="number" step="0.1" id="resistance_hum1_rs"></div>

                        <div>
                            <label>A tierra:</label><br>
                            <input type="number" id="resistance_hum1_to_ground"></div>

                        <div>
                            <label>Resistencia humidificador 2 (Œ©):</label><br>
                            <input type="number" step="0.1" id="resistance_hum2_rs"></div>

                        <div>
                            <label>A tierra:</label><br>
                            <input type="number" id="resistance_hum2_to_ground"></div>

                        <div>
                            <label>Resistencia circulador 1 (Œ©):*</label><br>
                            <input type="number" id="resistance_circ1_rs" required class="special-box">
                            <input type="number" id="resistance_circ1_rt" required class="special-box">
                            <input type="number" id="resistance_circ1_st" required class="special-box">
                        </div>
                        <div>
                            <label>A tierra:*</label><br>
                            <input type="number" id="resistance_circ1_to_ground" required class="special-box">
                        </div>

                        <div>
                            <label>Resistencia circulador 2 (Œ©):*</label><br>
                            <input type="number" id="resistance_circ2_rs">
                            <input type="number" id="resistance_circ2_rt">
                            <input type="number" id="resistance_circ2_st">
                        </div>
                        <div>
                            <label>A tierra:*</label><br>
                            <input type="number" id="resistance_circ2_to_ground">
                        </div>

                        <div>
                            <label>Resistencia circulador 3 (Œ©):*</label><br>
                            <input type="number" id="resistance_circ3_rs">
                            <input type="number" id="resistance_circ3_rt">
                            <input type="number" id="resistance_circ3_st">
                        </div>
                        <div>
                            <label>A tierra:*</label><br>
                            <input type="number" id="resistance_circ3_to_ground">
                        </div>


                        <div>
                            <label>Amperajes compresor HS o 1er compresor(A):</label><br>
                            <div><label>T1*<input type="number" id="current_hs_r" required class="special-box"></label>
                            </div>
                            <div><label>T2*<input type="number" id="current_hs_s" required class="special-box"></label>
                            </div>
                            <div><label>T3*<input type="number" id="current_hs_t" required class="special-box"></label>
                            </div>
                        </div>

                        <div>
                            <label>Amperajes compresor LS o 2do compresor(A):</label><br>
                            <div><label>T1*<input type="number" id="current_ls_r" required class="special-box"></label>
                            </div>
                            <div><label>T2*<input type="number" id="current_ls_s" required class="special-box"></label>
                            </div>
                            <div><label>T3*<input type="number" id="current_ls_t" required class="special-box"></label>
                            </div>
                        </div>

                        <div>
                            <label>Amperajes compresor HS monof√°sico o 1er compresor(A):</label><br>
                            <div><label>C <input type="number" id="current_hs_mono_c"></label></div>
                            <div><label>R <input type="number" id="current_hs_mono_r"></label></div>
                        </div>

                        <div>
                            <label>Amperajes compresor LS monof√°sico o 2do compresor(A):</label><br>
                            <div><label>C <input type="number" id="current_ls_mono_c"></label></div>
                            <div><label>R <input type="number" id="current_ls_mono_r"></label></div>
                        </div>

                        <div>
                            <label>Amperajes circuladores 1 (A):</label><br>
                            <input type="number" id="current_circ1_r" required class="special-box">
                            <input type="number" id="current_circ1_s" required class="special-box">
                            <input type="number" id="current_circ1_t" required class="special-box">
                        </div>

                        <div>
                            <label>Amperajes circuladores 2 (A):</label><br>
                            <input type="number" id="current_circ2_r">
                            <input type="number" id="current_circ2_s">
                            <input type="number" id="current_circ2_t">
                        </div>


                        <div>
                            <label>Amperajes circuladores 3 (A):</label><br>
                            <input type="number" id="current_circ3_r">
                            <input type="number" id="current_circ3_s">
                            <input type="number" id="current_circ3_t">
                        </div>

                        <div>
                            <label>Amperajes de head fan 1(A):</label><br>
                            <input type="number" id="current_headfan1_r">
                            <input type="number" id="current_headfan1_s">
                            <input type="number" id="current_headfan1_t">
                        </div>

                        <div>
                            <label>Amperajes de head fan 2(A):</label><br>
                            <input type="number" id="current_headfan2_r">
                            <input type="number" id="current_headfan2_s">
                            <input type="number" id="current_headfan2_t">
                        </div>

                        <div>
                            <label>Amperajes de Condensador 1 (A):</label><br>
                            <input type="number" id="current_cond1_fan_r" required class="special-box">
                            <input type="number" id="current_cond1_fan_s" required class="special-box">
                            <input type="number" id="current_cond1_fan_t" required class="special-box">
                        </div>

                        <div>
                            <label>Amperajes de Condensador 2 (A):</label><br>
                            <input type="number" id="current_cond2_fan_r">
                            <input type="number" id="current_cond2_fan_s">
                            <input type="number" id="current_cond2_fan_t">
                        </div>

                        <div>
                            <label>Amperajes de Condensador 3 (A):</label><br>
                            <input type="number" id="current_cond3_fan_r">
                            <input type="number" id="current_cond3_fan_s">
                            <input type="number" id="current_cond3_fan_t">
                        </div>

                        <div>
                            <label>Amperajes heater 1 (A):</label><br>
                            <input type="number" id="current_heat1_r" required class="special-box">
                            <input type="number" id="current_heat1_s" required class="special-box">
                            <input type="number" id="current_heat1_t" required class="special-box">
                        </div>

                        <div>
                            <label>Amperajes heater 2 (A):</label><br>
                            <input type="number" id="current_heat2_r">
                            <input type="number" id="current_heat2_s">
                            <input type="number" id="current_heat2_t">
                        </div>

                        <div>
                            <label>Amperajes heater 3 (A):</label><br>
                            <input type="number" id="current_heat3_r">
                            <input type="number" id="current_heat3_s">
                            <input type="number" id="current_heat3_t">
                        </div>

                        <div>
                            <label>Amperajes humidificador 1 (A):</label><br>
                            <input type="number" id="current_hum1" required class="special-box">
                        </div> 

                        <div>
                            <label>Amperajes humidificador 2 (A):</label><br>
                            <input type="number" id="current_hum2">
                        </div>  

                        <div>
                            <div><label>Voltaje de placa (V):</label></div>
                            <div><label><input type="text" id="voltage_plate" required class="special-box"></label></div>
                            <div><label>Voltaje de control (V):</label></div>
                            <div><label><input type="text" id="voltage_of_control"></label></div>
                            <label>Voltaje compresor HS o 1er compresor(V):</label><br>
                            <input type="number" id="voltaje_hs_r" required class="special-box">
                            <input type="number" id="voltaje_hs_s" required class="special-box">
                            <input type="number" id="voltaje_hs_t" required class="special-box">
                        </div>

                        <div>
                            <label>Voltaje compresor LS o 2do compresor(V):</label><br>
                            <input type="number" id="voltaje_ls_r">
                            <input type="number" id="voltaje_ls_s">
                            <input type="number" id="voltaje_ls_t">
                        </div>

                        <div>
                            <label>Presiones compresor HS o 1er compresor:*</label><br>
                            <input type="number" id="pressures_hs_suction" required class="special-box">
                            <input type="number" id="pressures_hs_disch" required class="special-box">
                            <label>Psi</label><br>
                        </div>

                        <div>
                            <label>Presiones compresor LS o 2do compresor:*</label><br>
                            <input type="number" id="pressures_ls_suction" required class="special-box">
                            <input type="number" id="pressures_ls_disch" required class="special-box">
                            <label>Psi</label><br>
                        </div>
                    </div>
                </div>
            </div>
    </div>
    <!-- 9 ‚Äì Observaciones -->
    <!-- Pregunta: ¬øCu√°ndo se sugiere el siguiente servicio? -->
    <br>
    <hr>
    <div class="section-header"><strong>5 ‚Äì ¬øCu√°ndo se sugiere el siguiente servicio?</strong></div>
    <div class="grid">
        <select id="resultado_servicio">
            <option value="">Seleccione...</option>
            <option value="3 meses"> En 3 meses</option>
            <option value="6 meses">En 6 meses</option>
            <option value="1 a√±o">En 1 a√±o</option>
        </select>
    </div>
    </div>
    <hr>
    <div class="section-header"><strong>6  ‚Äì  Falla Reportada o diagn√≥sticada</strong></div>
    <div class="fullwidth"><textarea id="fail_work" required class="special-box"></textarea></label></div><br>
    <div class="section-header"><label><strong>10 - Actividades realizadas:*<br></strong></label></div>
    <div class="fullwidth"><textarea id="act_work" required class="special-box"></textarea></label></div><br>


    <!-- 10 ‚Äì Observaciones -->
    <hr>
    <div class="section-header"><strong>7 ‚Äì Notas del Cliente</strong></div>
    <textarea id="notes_Cus" required class="special-box"></textarea>Observaciones del especialista

    <!-- 11 ‚Äì Firma de especialista -->
    <hr>
    <div class="section-header"><strong>8 ‚Äì Firma de especialista</strong></div>
    <div><label>Nombre de Especialista</label><input type="text" id="name_esp" required class="special-box"></div>
    <button type="button" id="openSignatureEsp">Firma de Especialista</button>
    <canvas id="signaturePreviewEsp" width="300" height="150" required class="special-box"></canvas>

    <!-- 12 ‚Äì Firma de cliente -->
    <hr>
    <div class="section-header"><strong>9 ‚Äì Firma de cliente</strong></div>
    <div><label>Nombre de Cliente</label><input type="text" id="name_cus" required class="special-box"></div>
    <button type="button" id="openSignatureCus">Firma de Cliente</button>
    <canvas id="signaturePreviewCus" width="300" height="150" required class="special-box"></canvas>
    <hr>
    <!-- Acciones -->
    <div class="form-actions">
        <button type="button" id="saveBtn">A) Guardar registro</button>
        <!-- Bot√≥n para enviar correo -->
        <button type="button" id="exportBtn">B) Descargar registro al m√≥vil</button>
        <button type="button" id="sendEmailBtn">C) Enviar reporte por correo</button>
    </div>
    <button type="button" id="deleteAllBtn" class="secondary">Borrar registros</button>
    <button type="button" id="clearBtn" class="secondary">Limpiar formulario</button>


    </form>

    <!-- Tabla de registros -->
    <div class="card">
        <div class="section-header"><strong>Registros capturados</strong></div>
        <div class="table-wrap">
            <table id="recordsTable">
                <thead>
                    <tr id="tableHead"></tr>
                </thead>
                <tbody id="tableBody"></tbody>
            </table>
        </div>
    </div>
    </div>

    <!-- Modal de firma -->
    <div id="signatureModal">
        <div id="signatureBox">
            <h3>Firma manuscrita</h3>
            <canvas id="signatureCanvas" width="300" height="150"></canvas>
            <div class="signature-actions">
                <button id="clearSignature">Limpiar</button>
                <button id="saveSignature">Guardar firma</button>
                <button id="closeSignature" class="secondary">Cerrar</button>
            </div>
        </div>
    </div>

    <!-- Tu archivo principal de JavaScript -->
    <script src="script.js"></script>
    </script>
</body>

</html>
