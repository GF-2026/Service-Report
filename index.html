<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reporte de Servicio</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <img id="logo" src="LOGO.png" alt="FIXSER">
            <div>
                <h1>REPORTE DE SERVICIO</h1>
                <div class="muted">Llena el formulario, firma y presiona "Guardar registro".</div>
            </div>
        </header>
        <form id="reportForm" class="card">
<!-- 1 – Datos de cliente -->
            <div class="section-header"><strong>1 – Datos de cliente</strong>
                <div class="muted">Campos obligatorios *</div>
            </div>
            <div class="grid">
                <div><label>OT: *</label><input type="text" id="OT" required></div>
                <div><label>Fecha y Hora: *</label><input type="datetime-local" id="datetime" required></div>
                <div><label>Compañía:</label><input type="text" id="company"></div>
                <div><label>Ingeniero a cargo:</label><input type="text" id="engineer"></div>
                <div><label>Teléfono:</label><input type="text" id="phone"></div>
                <div><label>Ciudad:</label><input type="text" id="city"></div>
            </div>
            <hr>
<!-- 2 – Datos del equipo -->            
            <div class="section-header"><strong>2 – Datos del equipo</strong></div>
            <div class="grid">
                <div><label>Descripción:</label><input type="text" id="description"></div>
                <div><label>Marca:</label><input type="text" id="brand"></div>
                <div><label>Modelo:</label><input type="text" id="model"></div>
                <div><label>Serie:</label><input type="text" id="serial"></div>
                <div><label>Número de control:</label><input type="text" id="controlnum"></div>
                <div><label>Estado Operativo:</label><input type="text" id="status"></div>
            </div>
            <hr>
<!-- 3 – Condiciones ambientales -->
            <div class="section-header"><strong>3 – Condiciones ambientales del site</strong></div>
            <div class="grid">
                <div><label>Ubicación de equipo:</label><input type="text" id="ubication"></div>
                <div><label>Temperatura (°C):</label><input type="number" step="0.1" id="temperature"></div>
                <div><label>Humedad (%):</label><input type="number" step="0.1" id="humidity"></div>
            </div>
            <div style="display: none;">            
<!-- 4 – Datos del equipo -->
            <hr>
            <div class="section-header"><strong>4 – Servicio solicitado</strong></div>
            <div class="grid">
                <div><label>Anote el código de falla y/o qué ocasiona:*</label><input type="text" id="info_fail"></div>
            </div>
<!-- 4– Inspección -->
            <hr>
            <div class="section-header"><strong>4 – Inspección inicial del equipo</strong></div>
            <div class="grid">
         
            <div><label>Revisar la operación del equipo:*<br></label><input type="text" id="satus"></div>
            <h6> Si detectas fallas antes de iniciar el servicio, toma evidencia.</h6>
            <div><label>Si el equipo no puede operar, explica porqué:<br></label><input type="text" id="if_not_work"></div>
            <div><label>Anota el número de parte a cambiar:<br></label><input type="text" id="part_change"></div>
            </div>
            
            <h6>Ubicar elemento a cambiar en el diagrama y adjuntar foto en el correo.</h6>
<!-- 5– Mediciones -->
            <hr>
            <div class="section-header"><strong>5 – Mediciones</strong></div>
            <div class="grid">
                    <div>
                        <label>Amperajes compresor HS (A):</label><br>
                        <div><label>Fase A</label><input type="text" id="current_hs_1"></div>
                        <div><label>Fase B</label><input type="text" id="current_hs_2"></div>
                        <div><label>Fase C</label><input type="text" id="current_hs_3"></div>
                    </div>

                    <div>
                        <label>Amperajes compresor LS (A):</label><br>
                        <div><label>Fase A</label><input type="text" id="current_ls_1"></div>
                        <div><label>Fase B</label><input type="text" id="current_ls_2"></div>
                        <div><label>Fase C</label><input type="text" id="current_ls_3"></div>
                    </div>

                    <div>
                        <label>Amperajes circuladores (A):</label><br>
                        <div><label>Fase de Circ. #1</label><input type="text" id="current_circ_1"></div>
                        <div><label>Fase de Circ. #2</label><input type="text" id="current_circ_2"></div>
                        <div><label>Fase de Circ. #3</label><input type="text" id="current_circ_3"></div>
                    </div>

                    <div>
                        <label>Amperajes heater (A):</label><br>
                        <div><label>H1-H2</label><input type="text" id="current_heat_1"></div>
                        <div><label>H1-H3</label><input type="text" id="current_heat_2"></div>
                        <div><label>H2-H3</label><input type="text" id="current_heat_3"></div>
                    </div>

                    <div>
                        <label>Amperajes humidificador (A):</label><br>
                        <div><label>Humidificador #1</label><input type="text" id="current_hum_1"></div>
                        <div><label>Humidificador #2</label><input type="text" id="current_hum_2"></div>
                        <div><label>Humidificador #3</label><input type="text" id="current_hum_3"></div>
                    </div>

                    <div>
                        <label>Presiones compresor HS: (Psi)</label><br>
                        <div><label>Presión de succión HS:</label><input type="text" id="pressures_hs_1"></div>
                        <div><label>Presión de descarga HS</label><input type="text" id="pressures_hs_2"></div>
                    </div>

                    <div>
                        <label>Presiones compresor LS (Psi):</label><br>
                        <div><label>Presión de succión LS:</label><input type="text" id="pressures_ls_1"></div>
                        <div><label>Presión de descarga LS:</label><input type="text" id="pressures_ls_2"></div>
                     </div>
                </div>
<!-- 6– Checklist eléctrico-->
            <hr>
            <div class="section-header"><strong>6 – Revisión eléctrica</strong></div>
            <div class="grid checkboxes">
                <label><input type="checkbox" id="main_switch">Switch principal, hardware y cables correctos</label>
                <label><input type="checkbox" id="switch_covers">Cubiertas de presostatos</label>
                <label><input type="checkbox" id="tighting">Conexiones reapretadas</label>
                <label><input type="checkbox" id="headfan">Revisión de headfans</label>
                <label><input type="checkbox" id="balance">Carga balanceada</label>
                <label><input type="checkbox" id="fuses_ok">Fusibles correctos</label>
                <label><input type="checkbox" id="faseado">Faseado correcto</label>
                <label><input type="checkbox" id="crankcase">Calentador de cárter</label>
                <label><input type="checkbox" id="grounded">Tierra física</label>
            </div>

<!-- 7 – Chequeo en refrigeración -->
            <hr>
            <div class="section-header"><strong>7 – Revisión en refrigeración</strong></div>
            <div class="grid checkboxes">
                <label><input type="checkbox" id="fans_ok">Ventiladores OK</label>
                <label><input type="checkbox" id="coils_ok">Serpentines OK</label>
                <label><input type="checkbox" id="armafles_ok">Armaflex OK</label>
                <label><input type="checkbox" id="inyection_ok">Válvula de inyección OK</label>
                <label><input type="checkbox" id="oil_ok">Nivel de aceite correcto</label>
                <label><input type="checkbox" id="sights_ok">Mirillas OK</label>
                <label><input type="checkbox" id="acid_ok">Prueba de acidez</label>
                <label><input type="checkbox" id="noleaks">Sin fugas</label>
                <label><input type="checkbox" id="hilow">Chequeo Hi/Low</label>
                <label><input type="checkbox" id="lowoil">Protección de aceite OK</label>
                <label><input type="checkbox" id="rotalocks">Capuchones de rotalocks</label>
                <label><input type="checkbox" id="capillaries">Capilares OK</label>
                <label><input type="checkbox" id="frosty">Escarche de succión</label>
            </div>

<!-- 8– Diagnóstico -->       
             <hr> 
            <div class="section-header"><strong>8 – Servicio ejecutado</strong></div>
            <div class="grid">
                <div class="fullwidth"><label>Falla reportada/encontrada:*</strong><textarea id="info_fail"></textarea></label></div><br>
                <div class="fullwidth"><label>Actividades del Servicio:*</strong><textarea id="act_work"></textarea></label></div><br>             
            </div>
                <div><label>Hora de inicio de labores en el equipo:*<br></label><input type="time" id="ini_work"></div>
             <div class="grid">
                <div><label>Hora de fin de labores en el equipo:*<br></strong></label><input type="time" id="fin_work"></div>
            </div>        
<!-- 9 – Pruebas -->
            <hr>
            <div class="section-header"><strong>9 – Pruebas</strong></div>
            <div class="grid">
                <div><label>Temp. ambiente (°C):</label><input type="text" id="heat_from"></div>
                <div><label>Punto máximo -10 (°C):</label><input type="text" id="heat_target"></div>
                <label><input type="checkbox" id="heat_test">Prueba de calentamiento (soak 30 min)</label>
                <div><label>Humedad baja (20 %HR):</label><input type="text" id="hum_low"></div>
                <div><label>Humedad alta (80 %HR):</label><input type="text" id="hum_high"></div>
                <label><input type="checkbox" id="hum_test">Prueba de humedad (soak 30 min c/u)</label>
                <div><label>Punto máximo -10 (°C):</label><input type="text" id="temp_high"></div>
                <div><label>Punto máximo +10 (°C):</label><input type="text" id="temp_low"></div>
                <label><input type="checkbox" id="cold_test">Prueba de enfriamiento (soak 30 min)</label>
                <div><label>Duración (min):</label><input type="text" id="pulldown"></div>
            </div>
<!-- 10 – Observaciones -->
            <hr>
            <div class="section-header"><strong>10 – Observaciones del cliente</strong></div>
            <textarea id="notes"></textarea>
<!-- 11 – Firma de especialista -->
            <hr>
            <div class="section-header"><strong>11 – Firma de especialista</strong></div>
            <div><label>Nombre de Especialista</label><input type="text" id="name_esp"></div>
            <button type="button" id="openSignatureEsp">Firma de Especialista</button>
            <canvas id="signaturePreviewEsp" width="300" height="150"></canvas>
<!-- 12 – Firma de cliente -->
            <hr>
            <div class="section-header"><strong>12 – Firma de cliente</strong></div>
            <div><label>Nombre de Cliente</label><input type="text" id="name_cus"></div>
            <button type="button" id="openSignatureCus">Firma de Cliente</button>
            <canvas id="signaturePreviewCus" width="300" height="150"></canvas>
            <hr>
<!-- Acciones -->
            <div class="form-actions">
                <button type="button" id="saveBtn">Guardar registro</button>
                <button type="button" id="clearBtn" class="secondary">Limpiar formulario</button>
                <button type="button" id="exportBtn">Exportar a Excel</button>
                <button type="button" id="deleteAllBtn" class="secondary">Borrar registros</button>
            </div>
        </form>
<!-- Tabla de registros -->
        <div class="card">
            <div class="section-header"><strong>Registros capturados</strong></div>
            <div class="table-wrap">
                <table id="recordsTable">
                    <thead>
                        <tr id="tableHead"></tr>
                    </thead>
                    <tbody id="tableBody"></tbody>
                </table>
            </div>
        </div>
    </div>
<!-- Modal de firma -->
    <div id="signatureModal">
        <div id="signatureBox">
            <h3>Firma manuscrita</h3>
            <canvas id="signatureCanvas" width="300" height="150"></canvas>
            <div class="signature-actions">
                <button id="clearSignature">Limpiar</button>
                <button id="saveSignature">Guardar firma</button>
                <button id="closeSignature" class="secondary">Cerrar</button>
            </div>
        </div>
    </div>
    <script src="script.js"></script>
</body>
</html>
